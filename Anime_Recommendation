{
  "cells": [
    {
      "cell_type": "markdown",
      "source": [
        "### Imports"
      ],
      "metadata": {
        "id": "NQgdXgvVdIB5"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "import matplotlib.pyplot as plt\n",
        "import re\n",
        "import time\n",
        "import warnings\n",
        "import numpy as np\n",
        "from sklearn.preprocessing import normalize\n",
        "from sklearn.feature_extraction.text import CountVectorizer\n",
        "from sklearn.manifold import TSNE\n",
        "import seaborn as sns\n",
        "from sklearn.metrics import confusion_matrix, accuracy_score, log_loss\n",
        "\n",
        "from sklearn.linear_model import SGDClassifier\n",
        "from imblearn.over_sampling import SMOTE\n",
        "\n",
        "from sklearn.model_selection import train_test_split\n",
        "from sklearn.model_selection import GridSearchCV\n",
        "import math\n",
        "warnings.filterwarnings(\"ignore\")\n",
        "\n",
        "\n",
        "from sklearn import model_selection\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "\n",
        "import pickle\n"
      ],
      "metadata": {
        "id": "wvfF0aEXbte0"
      },
      "execution_count": 1,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Downloading csv files"
      ],
      "metadata": {
        "id": "7v-3nsDxdLa6"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "!wget --header=\"Host: doc-0g-4k-docs.googleusercontent.com\" --header=\"User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\" --header=\"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\" --header=\"Accept-Language: en-GB,en-US;q=0.9,en;q=0.8\" --header=\"Cookie: AUTH_mm5pe75pf4mhpbdikb2k80b74s62g311_nonce=2c0hqefg23pgi\" --header=\"Connection: keep-alive\" \"https://doc-0g-4k-docs.googleusercontent.com/docs/securesc/lo66ka9s3k9ovif7kku17kum7962ok4j/qsjidfpnmj4diojc7cc9ek2g7tdcv8d7/1645937700000/08255761277798433337/08255761277798433337/18dK6EVVTOQmncVkR0TlydW8d9QZu5sOa?e=download&ax=ACxEAsZ0mDa1Kxbt_BnnIXEPrN9U3UVhQ7VNLzMRNviC34EXgDq_Zt2Yv19xTfOWYaAsU4MG5hmCRwb77fgVEbzKv8oLwcyBqGoaqlKGRjj2tgUmgw-cKnWmF74IK8azzeZk7I1hHOMvy_HUdpP00CGqayZFPekAw1aeH4iev8qRzjCuElnwDuQirD_nOksMOckOXVeErutphQzsgTHaMYLYrljP7PAlIW83XFGYhJE8IMU1e13ryeIMudi_5ojc8z5plTfdaArxehhYIbUWFFHr4Dwj2zDYmU-fMHJeivAFz1u6TZUHRVACFR_2BkxzIYVhaIYnaUgFBEFaTHudEOXEwlQ5eh-asBl231FgkrZgvdDIP8zmTtyCpI-ny43JP7552prniekYvrnuww5HyZis_kN2UjVCPhX-szSsZRiFVWFlHrdddAPrVLyzvukQ2P9UzrT3Ygj7UjKF8zUmiDwrUz7gw-LXQFZKq_D4AYgFmoxZgcRr_MOar1nkjkZuk1qxkiVKZJaFxfLgVf6CRlMQFNOx-ZBBOnWtq0dVdQTyAKdfGJ7qPxPjghwfpLjDM82U_XD2bJlR6blvO6QzUqV7GrvL4lunJbaSh11dMaZbLh7zu1JEksKa6uynhLew2u422LoiLMwiGSgzWrn2SjD7sQ-jc_oQax1FGHwM0AU&authuser=0&nonce=2c0hqefg23pgi&user=08255761277798433337&hash=1jm480unu8d6kqfkindl7ds9s5lmgdq1\" -c -O 'anime_recommendation.zip'"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "oscZXiE_cAJW",
        "outputId": "dca956e2-57e8-4583-a168-d5a2dc7feae0"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "--2022-02-27 04:56:31--  https://doc-0g-4k-docs.googleusercontent.com/docs/securesc/lo66ka9s3k9ovif7kku17kum7962ok4j/qsjidfpnmj4diojc7cc9ek2g7tdcv8d7/1645937700000/08255761277798433337/08255761277798433337/18dK6EVVTOQmncVkR0TlydW8d9QZu5sOa?e=download&ax=ACxEAsZ0mDa1Kxbt_BnnIXEPrN9U3UVhQ7VNLzMRNviC34EXgDq_Zt2Yv19xTfOWYaAsU4MG5hmCRwb77fgVEbzKv8oLwcyBqGoaqlKGRjj2tgUmgw-cKnWmF74IK8azzeZk7I1hHOMvy_HUdpP00CGqayZFPekAw1aeH4iev8qRzjCuElnwDuQirD_nOksMOckOXVeErutphQzsgTHaMYLYrljP7PAlIW83XFGYhJE8IMU1e13ryeIMudi_5ojc8z5plTfdaArxehhYIbUWFFHr4Dwj2zDYmU-fMHJeivAFz1u6TZUHRVACFR_2BkxzIYVhaIYnaUgFBEFaTHudEOXEwlQ5eh-asBl231FgkrZgvdDIP8zmTtyCpI-ny43JP7552prniekYvrnuww5HyZis_kN2UjVCPhX-szSsZRiFVWFlHrdddAPrVLyzvukQ2P9UzrT3Ygj7UjKF8zUmiDwrUz7gw-LXQFZKq_D4AYgFmoxZgcRr_MOar1nkjkZuk1qxkiVKZJaFxfLgVf6CRlMQFNOx-ZBBOnWtq0dVdQTyAKdfGJ7qPxPjghwfpLjDM82U_XD2bJlR6blvO6QzUqV7GrvL4lunJbaSh11dMaZbLh7zu1JEksKa6uynhLew2u422LoiLMwiGSgzWrn2SjD7sQ-jc_oQax1FGHwM0AU&authuser=0&nonce=2c0hqefg23pgi&user=08255761277798433337&hash=1jm480unu8d6kqfkindl7ds9s5lmgdq1\n",
            "Resolving doc-0g-4k-docs.googleusercontent.com (doc-0g-4k-docs.googleusercontent.com)... 74.125.142.132, 2607:f8b0:400e:c08::84\n",
            "Connecting to doc-0g-4k-docs.googleusercontent.com (doc-0g-4k-docs.googleusercontent.com)|74.125.142.132|:443... connected.\n",
            "HTTP request sent, awaiting response... 200 OK\n",
            "Length: 26329659 (25M) [application/zip]\n",
            "Saving to: ‘anime_recommendation.zip’\n",
            "\n",
            "anime_recommendatio 100%[===================>]  25.11M  72.6MB/s    in 0.3s    \n",
            "\n",
            "2022-02-27 04:56:32 (72.6 MB/s) - ‘anime_recommendation.zip’ saved [26329659/26329659]\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!unzip anime_recommendation.zip"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "NqrAsQKHc6Qx",
        "outputId": "c0477e9c-ea6d-4935-9454-e988e5259874"
      },
      "execution_count": 3,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Archive:  anime_recommendation.zip\n",
            "  inflating: anime.csv               \n",
            "  inflating: __MACOSX/._anime.csv    \n",
            "  inflating: rating.csv              \n",
            "  inflating: __MACOSX/._rating.csv   \n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Reading csv files"
      ],
      "metadata": {
        "id": "xW9seXmodY4n"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Reading anime csv file"
      ],
      "metadata": {
        "id": "LqhTdcaYd2HI"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "anime_data = pd.read_csv('anime.csv')\n",
        "anime_data.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "9FNhFg7Xdd7X",
        "outputId": "4896eedf-9131-4834-f737-9621adab6d55"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-618a55ad-1ef0-4fac-b9da-8d46948220cd\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>anime_id</th>\n",
              "      <th>name</th>\n",
              "      <th>genre</th>\n",
              "      <th>type</th>\n",
              "      <th>episodes</th>\n",
              "      <th>rating</th>\n",
              "      <th>members</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>32281</td>\n",
              "      <td>Kimi no Na wa.</td>\n",
              "      <td>Drama, Romance, School, Supernatural</td>\n",
              "      <td>Movie</td>\n",
              "      <td>1</td>\n",
              "      <td>9.37</td>\n",
              "      <td>200630</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>5114</td>\n",
              "      <td>Fullmetal Alchemist: Brotherhood</td>\n",
              "      <td>Action, Adventure, Drama, Fantasy, Magic, Mili...</td>\n",
              "      <td>TV</td>\n",
              "      <td>64</td>\n",
              "      <td>9.26</td>\n",
              "      <td>793665</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>28977</td>\n",
              "      <td>Gintama°</td>\n",
              "      <td>Action, Comedy, Historical, Parody, Samurai, S...</td>\n",
              "      <td>TV</td>\n",
              "      <td>51</td>\n",
              "      <td>9.25</td>\n",
              "      <td>114262</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>9253</td>\n",
              "      <td>Steins;Gate</td>\n",
              "      <td>Sci-Fi, Thriller</td>\n",
              "      <td>TV</td>\n",
              "      <td>24</td>\n",
              "      <td>9.17</td>\n",
              "      <td>673572</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>9969</td>\n",
              "      <td>Gintama&amp;#039;</td>\n",
              "      <td>Action, Comedy, Historical, Parody, Samurai, S...</td>\n",
              "      <td>TV</td>\n",
              "      <td>51</td>\n",
              "      <td>9.16</td>\n",
              "      <td>151266</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-618a55ad-1ef0-4fac-b9da-8d46948220cd')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-618a55ad-1ef0-4fac-b9da-8d46948220cd button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-618a55ad-1ef0-4fac-b9da-8d46948220cd');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "   anime_id                              name  ... rating members\n",
              "0     32281                    Kimi no Na wa.  ...   9.37  200630\n",
              "1      5114  Fullmetal Alchemist: Brotherhood  ...   9.26  793665\n",
              "2     28977                          Gintama°  ...   9.25  114262\n",
              "3      9253                       Steins;Gate  ...   9.17  673572\n",
              "4      9969                     Gintama&#039;  ...   9.16  151266\n",
              "\n",
              "[5 rows x 7 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 4
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Reading rating csv file"
      ],
      "metadata": {
        "id": "Q3VIrS_9d8mQ"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "rating_data = pd.read_csv('rating.csv')\n",
        "rating_data.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "BwU3iluJeBDe",
        "outputId": "323e70bd-3898-408f-91f8-cc704d1ac099"
      },
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-38b96429-499c-448c-bdb0-e1edd49b748e\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>user_id</th>\n",
              "      <th>anime_id</th>\n",
              "      <th>rating</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20</td>\n",
              "      <td>-1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>-1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>1</td>\n",
              "      <td>79</td>\n",
              "      <td>-1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1</td>\n",
              "      <td>226</td>\n",
              "      <td>-1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1</td>\n",
              "      <td>241</td>\n",
              "      <td>-1</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-38b96429-499c-448c-bdb0-e1edd49b748e')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-38b96429-499c-448c-bdb0-e1edd49b748e button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-38b96429-499c-448c-bdb0-e1edd49b748e');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "   user_id  anime_id  rating\n",
              "0        1        20      -1\n",
              "1        1        24      -1\n",
              "2        1        79      -1\n",
              "3        1       226      -1\n",
              "4        1       241      -1"
            ]
          },
          "metadata": {},
          "execution_count": 5
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "66ibGJ74hCde",
        "outputId": "6e383950-724d-4b43-c2e5-fef78810987c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(12294, 7)\n",
            "(7813737, 3)\n"
          ]
        }
      ],
      "source": [
        "print(anime_data.shape)\n",
        "print(rating_data.shape)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "rating_data['rating'].describe()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "vKNUL03VfNsX",
        "outputId": "7b3d3eba-d1ec-41ca-901a-e1b7e12e16e6"
      },
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "count    7.813737e+06\n",
              "mean     6.144030e+00\n",
              "std      3.727800e+00\n",
              "min     -1.000000e+00\n",
              "25%      6.000000e+00\n",
              "50%      7.000000e+00\n",
              "75%      9.000000e+00\n",
              "max      1.000000e+01\n",
              "Name: rating, dtype: float64"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### EDA"
      ],
      "metadata": {
        "id": "sxsEQeBEfegJ"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Plotting rating histogram"
      ],
      "metadata": {
        "id": "HlmHoMuqflbr"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "rating_data.hist(column='rating');\n",
        "plt.xlabel(\"Movie ratings\")\n",
        "plt.ylabel(\"probability of ratings\")\n",
        "plt.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 295
        },
        "id": "46xNQySLfheK",
        "outputId": "f29e735a-dff5-4133-ad74-30622ca4b318"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEWCAYAAABrDZDcAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAaI0lEQVR4nO3dfZQddZ3n8fcnCY9pSJS4gUkydsQIyySg0DwojtMZ9RhEYB1QeRAJCxvdFQEXHII7irrsiucMrIBgNmoMD0qjghohg6NABBQ9SQATCMsaeZBESACHQAIiId/9o6rlbqf73uru+6vrvfV5ndOnbz3cqu8vfdOfrl9V/UoRgZmZVdeYVhdgZmat5SAwM6s4B4GZWcU5CMzMKs5BYGZWcQ4CM7OKcxCYNYmkBZI+0+o6zIZLvo/AbPgkzQVOj4i3t7oWs9HyEYHZICSNa3UNZmVxEJjlJD0q6TxJq4Atkv5J0m8lPS9pjaT35+v9e2AB8FZJmyU9m89fLOnC/HWvpHWSzpG0UdITkk6t2dcekn4k6TlJyyVdKOmuFjTbzEFgNsAJwJHAROAh4G+BCcDngWsl7RURDwIfA+6OiK6ImDjEtvbM3zsFOA24QtJr8mVXAFvydU7Jv8xaoi2DQNKi/K+s+wuu/8H8L7oHJH07dX3W1i6LiMcj4sWI+G5E/D4itkXE9cBvgEOGsa2XgS9ExMsRsRTYDOwjaSxwLHBBRLwQEWuAq5reErOC2jIIgMXAnCIrSpoBnA8cHhF/A5ydsC5rf4/3v5D0EUn3SXo27/6ZCUwaxraeiYitNdMvAF3A64Bxtfsa8NqsVG0ZBBFxB/CH2nmS9pZ0i6SVku6UtG++6D8BV0TEv+Xv3VhyudZeAkDS64GvAWcAe+TdP/cDql1vhJ4CtgJTa+ZNG8X2zEalLYNgCAuBT0TEQcC5wJX5/DcBb5L0c0m/lFToSMIqbzzZL/unAPITvTNrlm8ApkracbgbjohXgBuBz0naNf+j5SOjL9lsZDriEjlJXcDbgO9K/X+wsVP+fRwwA+gl+wvsDkmzIuLZsuu09hERayRdDNwNbAOuBn5es8ptwAPAk5K2RcRwuowgO9JYDDxJdlL6OqBntHWbjUTb3lAmqRu4KSJmStodeCgi9hpkvQXAryLim/n0rcD8iFheZr1m9Uj6ErBnRPjqIStdR3QNRcRzwCOSPgCgzAH54h+QHQ0gaRJZV9HDrajTrJ+kfSXtn39WDyG7vPT7ra7Lqqktg0DSdWSH7PvkN+2cBpwEnCbp12SH7Mfkq/8YeEbSGuB24FMR8Uwr6jarsRvZeYItwPXAxcAPW1qRVVbbdg2ZmVlztOURgZmZNU/bXTU0adKk6O7ubnUZhWzZsoXx48e3uowkOrlt0Nntc9va12jat3Llyqcj4nWDLWu7IOju7mbFihWtLqOQZcuW0dvb2+oykujktkFnt89ta1+jaZ+kx4Za5q4hM7OKcxCYmVWcg8DMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWBmVnEOAjOzimu7O4vNzFqpe/7NLdv34jlphs/wEYGZWcU5CMzMKs5BYGZWcQ4CM7OKcxCYmVWcg8DMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWBmVnEOAjOzinMQmJlVnIPAzKziHARmZhWXLAgkTZN0u6Q1kh6QdNYg60jSZZLWSlol6cBU9ZiZ2eBSPphmK3BORNwjaTdgpaSfRMSamnWOAGbkX4cCX82/m5lZSZIdEUTEExFxT/76eeBBYMqA1Y4Bro7ML4GJkvZKVZOZmW1PEZF+J1I3cAcwMyKeq5l/E3BRRNyVT98KnBcRKwa8fx4wD2Dy5MkH9fX1Ja+5GTZv3kxXV1ery0iik9sGnd0+t210Vq/flHT79UyfMHbE7Zs9e/bKiOgZbFnyZxZL6gJuAM6uDYHhiIiFwEKAnp6e6O3tbV6BCS1btox2qXW4Orlt0Nntc9tGZ26Ln1mcon1JrxqStANZCHwrIm4cZJX1wLSa6an5PDMzK0nKq4YEfAN4MCIuGWK1JcBH8quHDgM2RcQTqWoyM7PtpewaOhw4GVgt6b583qeBvwaIiAXAUuC9wFrgBeDUhPWYmdkgkgVBfgJYDdYJ4OOpajAzs8Z8Z7GZWcU5CMzMKs5BYGZWcQ4CM7OKcxCYmVWcg8DMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWBmVnEOAjOzinMQmJlVnIPAzKziHARmZhXnIDAzqzgHgZlZxTkIzMwqzkFgZlZxDgIzs4pzEJiZVZyDwMys4hwEZmYV1zAIJO0taaf8da+kMyVNTF+amZmVocgRwQ3AK5LeCCwEpgHfTlqVmZmVpkgQbIuIrcD7gcsj4lPAXmnLMjOzshQJgpclnQCcAtyUz9shXUlmZlamIkFwKvBW4H9ExCOSpgPXpC3LzMzKMq7RChGxBjizZvoR4EspizIza6R7/s3bzTtn1lbmDjLf6msYBJJWAzFg9iZgBXBhRDyTojAzMytHwyAA/gV4hVevFDoe2BV4ElgMHJWkMjMzK0WRIHhXRBxYM71a0j0RcaCkD6cqzMzMylHkZPFYSYf0T0g6GBibT25NUpWZmZWmyBHB6cAiSV2AgOeA0yWNB76YsjgzM0uvyFVDy4FZkibk05tqFn8nVWFmZlaOIlcN7QQcC3QD4yQBEBFfSFqZmZmVokjX0A/JLhddCbyUthwzMytbkSCYGhFzkldiZmYtUeSqoV9ImjXcDUtaJGmjpPuHWN4raZOk+/Kvzw53H2ZmNnpFjgjeDsyV9AhZ15CAiIj9G7xvMfAV4Oo669wZEe8rUqiZmaVRJAiOGMmGI+IOSd0jea+ZmZVHEQOHEcoXSLtHxHOSXjvY8oj4Q8ONZ0FwU0TMHGRZL9lDb9YBvwfOjYgHhtjOPGAewOTJkw/q6+trtOu/CJs3b6arq6vVZSTRyW2Dzm5fp7Rt9fpN282bvAtseLEFxZRk+oSxI/7ZzZ49e2VE9Ay2rF4Q3BQR78u7hIKsS6hfRMQbGu24QRDsTvbQm82S3gtcGhEzGm2zp6cnVqxY0Wi1vwjLli2jt7e31WUk0cltg85uX6e0bajRRy9eXaSjoz0tnjN+xD87SUMGwZD/Yv199xExfUR7bSAinqt5vVTSlZImRcTTKfYHg39wUqodEvfRi44sdd9mZkUVeXj9rUXmDZekPZXfnZaPZTQG8JDWZmYlG/KIQNLOZMNNT5L0Gl7tGtodmNJow5KuA3rz968DLiB/xGVELACOA/6zpK3Ai8DxMVQ/lZmZJVOvM+2jwNnAX5HdVdwfBM+RXRZaV0Sc0GD5V4psx8zM0qp3juBS4FJJn4iIy0usyczMSlRk9NHLJc0E9gN2rplf70YxMzNrE0VGH72ArK9/P2Ap2Q1md1H/jmEzM2sTRcYaOg54J/BkRJwKHABMSFqVmZmVpkgQvBgR24Ct+U1gG4FpacsyM7OyFLkFb4WkicDXyK4e2gzcnbQqMzMrTd0gyG/4+mJEPAsskHQLsHtErCqlOjP7i1b23fqWRt0giIiQtBSYlU8/WkZRZmZWniLnCO6RdHDySszMrCWKnCM4FDhJ0mPAFoo/mMbMzNpAkSB4T/IqzMysZYrcWfxYGYWYmVlrFDlHYGZmHWzIIJC0U5mFmJlZa9Q7IrgbQNI1JdViZmYtUO8cwY6STgTeJukfBi6MiBvTlWVmZmWpFwQfA04CJgJHDVgWgIPAzKwD1HswzV3AXZJWRMQ3SqzJzMxKVOQ+gmsknQm8I5/+GbAgIl5OV5aZmZWlSBBcSfbQ+Svz6ZOBrwKnpyrKzMzKUyQIDo6IA2qmb5P061QFmZlZuYrcUPaKpL37JyS9AXglXUlmZlamIkcEnwJul/Qw2YBzrwdOTVqVmZmVpshYQ7dKmgHsk896KCJeSluWmZmVpcgRAfkvfj+VzMysA3nQOTOzinMQmJlVXMMgkHSjpCMlOTTMzDpQkV/uVwInAr+RdJGkfRq9wczM2kfDIIiIn0bEScCBwKPATyX9QtKpknZIXaCZmaVVqLtH0h7AXLJhJe4FLiULhp8kq8zMzErR8PJRSd8nu4fgGuCoiHgiX3S9pBUpizMzs/SK3EfwtYhYWjtD0k4R8VJE9CSqy8zMSlKka+jCQebd3exCzMysNYY8IpC0JzAF2EXSW8jGGQLYHdi1hNrMzKwE9bqG3kN2gngqcEnN/OeBTyesyczMSlTvUZVXAVdJOjYibiixJjMzK1G9rqEPR8S1QLek/zpweURcMsjbzMyszdQ7WTw+/94F7DbIV12SFknaKOn+IZZL0mWS1kpaJenAYdZuZmZNUK9r6H/n3z8/wm0vBr4CXD3E8iOAGfnXoWTPQT50hPsyM7MRqtc1dFm9N0bEmQ2W3yGpu84qxwBXR0QAv5Q0UdJeNTesmZlZCZT9Hh5kgXRKvTfmJ5PrbzwLgpsiYuYgy24CLoqIu/LpW4HzImK7u5UlzQPmAUyePPmgvr6+Rrse1Or1m0b0vpGavAtseDF7PWvKhFL3ndrmzZvp6upqdRnJdHL7mtm2sv9PNVL7f64TTZ8wdsQ/u9mzZ68c6ibgRlcN/UWIiIXAQoCenp7o7e0d0Xbmzr+5iVU1ds6srVy8OvsnfvSk3lL3ndqyZcsY6c+hHXRy+5rZtrL/TzVS+3+uEy2eMz7J57Je19CXI+JsST8CtjtsiIijR7nv9cC0mump+TwzMytRvei8Jv/+z4n2vQQ4Q1If2UniTT4/YGZWvnpdQyvz7z+TtCOwL9mRwUMR8adGG5Z0HdALTJK0DrgA2CHf5gJgKfBeYC3wAnDqqFpiZmYjUmQY6iOBBcBvycYbmi7poxHxL/XeFxEnNFgewMeHUauZmSVQ5KzKxcDsiFgLIGlv4GagbhCYmVl7KDIM9fP9IZB7mGzgOTMz6wD1rhr6h/zlCklLge+QnSP4ALC8hNrMzKwE9bqGjqp5vQH4u/z1U8AuySoyM7NS1btqyFfxmJlVQJGrhnYGTgP+Bti5f35E/MeEdZmZWUmKnCy+BtiT7IllPyO7A9gni83MOkSRIHhjRHwG2JKPP3QkHi7azKxjFAmCl/Pvz0qaCUwA/l26kszMrExFbihbKOk1wGfIxgfqyl+bmVkHaBgEEfH1/OXPgDekLcfMzMrWsGtI0h6SLpd0j6SVkr4saY8yijMzs/SKnCPoAzYCxwLHAU8D16csyszMylPkHMFeEfHfa6YvlPShVAWZmVm5ihwR/Kuk4yWNyb8+CPw4dWFmZlaOeoPOPU82yJyAs4Fr80VjgM3AucmrMzOz5OqNNbRbmYWYmVlrFDlHgKSjgXfkk8si4qZ0JZmZWZmKXD56EXAWsCb/OkvSF1MXZmZm5ShyRPBe4M0RsQ1A0lXAvcD5KQszM7NyFLlqCGBizesJKQoxM7PWKHJE8D+BeyXdTnYF0TuA+UmrMjOz0tQNAkljgG3AYcDB+ezzIuLJ1IWZmVk56gZBRGyT9I8R8R2ykUfNzKzDFDlH8FNJ50qaJum1/V/JKzMzs1IUOUfQP67Qx2vmBR6S2sysIxR5HsH0MgoxM7PWaBgEknYG/gvwdrIjgTuBBRHxx8S1mZlZCYp0DV0NPA9cnk+fCFwDfCBVUWY2PN3zby687jmztjJ3GOtb5ysSBDMjYr+a6dslrUlVkJmZlavIVUP3SDqsf0LSocCKdCWZmVmZihwRHAT8QtLv8um/Bh6StBqIiNg/WXVmZpZckSCYk7wKMzNrmSKXjz5WRiFmZtYaRUcfNTOzDuUgMDOrOAeBmVnFOQjMzCouaRBImiPpIUlrJW33MBtJcyU9Jem+/Ov0lPWYmdn2ilw+OiKSxgJXAO8G1gHLJS2JiIF3JV8fEWekqsPMzOpLeURwCLA2Ih6OiD8BfcAxCfdnZmYjoIhIs2HpOGBORJyeT58MHFr717+kucAXgaeA/wt8MiIeH2Rb84B5AJMnTz6or69vRDWtXr9pRO8bqcm7wIYXs9ezpkwodd+pbd68ma6urlaXkUy7tW84n+3az2Wn6eS2AUyfMHbEn8vZs2evjIiewZYl6xoq6EfAdRHxkqSPAlcBfz9wpYhYCCwE6Onpid7e3hHtrOwRF8+ZtZWLV2f/xI+e1FvqvlNbtmwZI/05tIN2a99wPtu1n8tO08ltA1g8Z3ySz2XKrqH1wLSa6an5vD+LiGci4qV88utk4xqZmVmJUgbBcmCGpOmSdgSOB5bUriBpr5rJo4EHE9ZjZmaDSHYMFRFbJZ0B/BgYCyyKiAckfQFYERFLgDMlHQ1sBf4AzE1Vj5mZDS5pZ1pELAWWDpj32ZrX5wPnp6zBzMzq853FZmYV5yAwM6s4B4GZWcU5CMzMKs5BYGZWcQ4CM7OKcxCYmVWcg8DMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWBmVnEOAjOziuvcZ7qZtUB3yY9DNWsGHxGYmVWcg8DMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWBmVnEOAjOzinMQmJlVnIPAzKziHARmZhXnIDAzqzgHgZlZxTkIzMwqzkFgZlZxDgIzs4rzg2ms4zTj4TDnzNrKXD9kxirCRwRmZhXnIDAzqzgHgZlZxTkIzMwqzkFgZlZxvmrIkmnG1Ttmll7SIwJJcyQ9JGmtpPmDLN9J0vX58l9J6k5Zj5mZbS/ZEYGkscAVwLuBdcBySUsiYk3NaqcB/xYRb5R0PPAl4EOpamqlTvvr2NfZm3WOlEcEhwBrI+LhiPgT0AccM2CdY4Cr8tffA94pSQlrMjOzARQRaTYsHQfMiYjT8+mTgUMj4oyade7P11mXT/82X+fpAduaB8zLJ/cBHkpSdPNNAp5uuFZ76uS2QWe3z21rX6Np3+sj4nWDLWiLk8URsRBY2Oo6hkvSiojoaXUdKXRy26Cz2+e2ta9U7UvZNbQemFYzPTWfN+g6ksYBE4BnEtZkZmYDpAyC5cAMSdMl7QgcDywZsM4S4JT89XHAbZGqr8rMzAaVrGsoIrZKOgP4MTAWWBQRD0j6ArAiIpYA3wCukbQW+ANZWHSStuvOGoZObht0dvvctvaVpH3JThabmVl78BATZmYV5yAwM6s4B0EijYbXaFeSpkm6XdIaSQ9IOqvVNTWbpLGS7pV0U6traTZJEyV9T9L/kfSgpLe2uqZmkfTJ/DN5v6TrJO3c6ppGQ9IiSRvz+636571W0k8k/Sb//ppm7MtBkEDN8BpHAPsBJ0jar7VVNc1W4JyI2A84DPh4B7Wt31nAg60uIpFLgVsiYl/gADqknZKmAGcCPRExk+wClXa/+GQxMGfAvPnArRExA7g1nx41B0EaRYbXaEsR8URE3JO/fp7sF8mU1lbVPJKmAkcCX291Lc0maQLwDrKr9YiIP0XEs62tqqnGAbvk9yTtCvy+xfWMSkTcQXY1Za3aYXmuAv5DM/blIEhjCvB4zfQ6OuiXZb98tNi3AL9qbSVN9WXgH4FtrS4kgenAU8A3866vr0sa3+qimiEi1gP/DPwOeALYFBH/2tqqkpgcEU/kr58EJjdjow4CGxFJXcANwNkR8Vyr62kGSe8DNkbEylbXksg44EDgqxHxFmALTepaaLW8r/wYsrD7K2C8pA+3tqq08ptvm3L9v4MgjSLDa7QtSTuQhcC3IuLGVtfTRIcDR0t6lKw77+8lXdvakppqHbAuIvqP4L5HFgyd4F3AIxHxVES8DNwIvK3FNaWwQdJeAPn3jc3YqIMgjSLDa7SlfJjwbwAPRsQlra6nmSLi/IiYGhHdZD+z2yKiY/6qjIgngccl7ZPPeiewps5b2snvgMMk7Zp/Rt9Jh5wIH6B2WJ5TgB82Y6NtMfpouxlqeI0Wl9UshwMnA6sl3ZfP+3RELG1hTVbcJ4Bv5X+gPAyc2uJ6miIifiXpe8A9ZFe23UubDzch6TqgF5gkaR1wAXAR8B1JpwGPAR9syr48xISZWbW5a8jMrOIcBGZmFecgMDOrOAeBmVnFOQjMzCrOQWAdQ1LU3gAmaZykp0Y6iqikj0n6SPMq/PN2uyWdWDPdI+myZu/HrCjfR2CdZAswU9IuEfEi8G5GcUd3RCwY6XsljYuIrUMs7gZOBL6d72cFsGKk+zIbLR8RWKdZSjZ6KMAJwHX9C/Kx3H8gaZWkX0raX9IYSY9Kmliz3m8kTZb0OUnn5vP2lnSLpJWS7pS078Ad5+tfI+nnZM/i7s7XvSf/6h/y4CLgbyXdl4+h39t/1JJvY5GkZZIelnRmzfY/kz/j4q58vP3+2s7Mnw+xSlJfc/85rQocBNZp+oDj84eS7M//PzLq54F7I2J/4NPA1RGxjew2/fcDSDoUeCwiNgzY7kLgExFxEHAucOUQ+98PeFdEnEA2Dsy7I+JA4ENAf/fPfODOiHhzRPyvQbaxL/AesuHML5C0g6SDgWPJniFwBNBTs/584C15uz5W59/GbFDuGrKOEhGr8uGxTyA7Oqj1drJfpkTEbZL2kLQ7cD3wWeCbZGMMXV/7pnyk1bcB382GsQFgpyFKWJJ3SwHsAHxF0puBV4A3FWzGzRHxEvCSpI1kQw0fDvwwIv4I/FHSj2rWX0U2bMQPgB8U3IfZnzkIrBMtIRubvhfYo8D6dwNvlPQ6sgd9XDhg+Rjg2Yh4c4Ftbal5/UlgA9lf8WOAPxZ4P8BLNa9fofH/0yPJHjhzFPDfJM2qc37CbDvuGrJOtAj4fESsHjD/TuAkAEm9wNMR8Vw+rvv3gUvIRlV9pvZN+fMWHpH0gfy9knRAgTomAE/k3U8nkw1ACPA8sNsw2/Rz4ChJO+dHKO/LaxkDTIuI24Hz8n12DXPbVnE+IrCOExHreLU/vtbngEWSVgEv8OpwvpB1By0H5g6x2ZOAr0r6J7Iunz7g1w1KuRK4Ib8E9RZePVpYBbwi6ddkz6W9t8F2iIjlkpbk790ArAY2kYXLtfljKAVc1mGPn7QSePRRszYhqSsiNkvaFbgDmNf//Giz0fARgVn7WChpP2Bn4CqHgDWLjwjMzCrOJ4vNzCrOQWBmVnEOAjOzinMQmJlVnIPAzKzi/h9p4Ig5RAWgZAAAAABJRU5ErkJggg==\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "rating_data['rating'].value_counts()\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "lTP25EU7iGmK",
        "outputId": "5e640dc1-c6e9-403b-8005-99972f1c014a"
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              " 8     1646019\n",
              "-1     1476496\n",
              " 7     1375287\n",
              " 9     1254096\n",
              " 10     955715\n",
              " 6      637775\n",
              " 5      282806\n",
              " 4      104291\n",
              " 3       41453\n",
              " 2       23150\n",
              " 1       16649\n",
              "Name: rating, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "1. Almost 14lakh ratings haven't been done\n",
        "2. The rating 1 occurs the least number of times\n",
        "3. The rating 8 occurs the most number of times"
      ],
      "metadata": {
        "id": "PtXgQn--hRKk"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "len(rating_data.user_id.unique())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ydoPyCJcjtaa",
        "outputId": "40407326-8a09-4a31-cf2a-e6f263158934"
      },
      "execution_count": 18,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "73515"
            ]
          },
          "metadata": {},
          "execution_count": 18
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "len(rating_data.anime_id.unique())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Zh5usMrLkIhd",
        "outputId": "b814a33d-956c-43fc-ef87-5792b04dd925"
      },
      "execution_count": 19,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "11200"
            ]
          },
          "metadata": {},
          "execution_count": 19
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "grouped_by_user = rating_data.groupby(\"user_id\")\n",
        "print(grouped_by_user.count())\n",
        "print(\"On average a user has rated these many movies: \", grouped_by_user.count().anime_id.mean())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "YTMVo5KLmNcN",
        "outputId": "cc33cf33-0df8-40f4-b561-e31473b836ab"
      },
      "execution_count": 24,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "         anime_id  rating\n",
            "user_id                  \n",
            "1             153     153\n",
            "2               3       3\n",
            "3              94      94\n",
            "4              52      52\n",
            "5             467     467\n",
            "...           ...     ...\n",
            "73512          13      13\n",
            "73513          33      33\n",
            "73514           1       1\n",
            "73515         196     196\n",
            "73516           2       2\n",
            "\n",
            "[73515 rows x 2 columns]\n",
            "On average a user has rated these many movies:  106.28765558049378\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "grouped_by_movie = rating_data.groupby(\"anime_id\")\n",
        "print(grouped_by_movie.count())\n",
        "print('On average a movie has been rated by these many users: ', grouped_by_movie.count().user_id.mean())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "M6KdnImZnR_9",
        "outputId": "247664ff-77f8-42c7-bb2f-5d480f927785"
      },
      "execution_count": 26,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "          user_id  rating\n",
            "anime_id                 \n",
            "1           15509   15509\n",
            "5            6927    6927\n",
            "6           11077   11077\n",
            "7            2629    2629\n",
            "8             413     413\n",
            "...           ...     ...\n",
            "34367           5       5\n",
            "34412           1       1\n",
            "34475           4       4\n",
            "34476           1       1\n",
            "34519           1       1\n",
            "\n",
            "[11200 rows x 2 columns]\n",
            "On average a movie has been rated by these many users:  697.6550892857143\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "mvB8SDS_hW03"
      },
      "source": [
        "### Pre-processing"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Removing rows that don't have rating"
      ],
      "metadata": {
        "id": "hhhvUjaz5IQQ"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "no_rating_data = rating_data[rating_data['rating'] == -1] \n",
        "print(no_rating_data.head())\n",
        "print(no_rating_data.shape)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IB6B5hhK5N_v",
        "outputId": "3bd96947-da8c-4e24-80be-df61b74c8500"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "   user_id  anime_id  rating\n",
            "0        1        20      -1\n",
            "1        1        24      -1\n",
            "2        1        79      -1\n",
            "3        1       226      -1\n",
            "4        1       241      -1\n",
            "(1476496, 3)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Creating Adjacency Matrix"
      ],
      "metadata": {
        "id": "8J14BqeXrHY2"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "collapsed": true,
        "id": "t44MNT40hZQW"
      },
      "outputs": [],
      "source": [
        "from scipy.sparse import csr_matrix\n",
        "import numpy as np\n",
        "\n",
        "rows = rating_data['user_id'].values\n",
        "columns = rating_data['anime_id'].values\n",
        "values = rating_data['rating'].values\n",
        "\n",
        "\n",
        "adjacency_matrix = csr_matrix((values, (rows, columns)), shape=(np.amax(rows)+1, np.amax(columns)+1))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 11,
      "metadata": {
        "id": "-mCgC0WbhZTO",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "7ea5b617-24f9-4deb-be3f-de517b521d1c"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(73517, 34476)"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ],
      "source": [
        "adjacency_matrix.shape"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "OJPWI9VwD_ih"
      },
      "source": [
        "#### Matrix Factorization"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 12,
      "metadata": {
        "id": "ZYnsKBmFEIg3",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "47929619-ff76-464b-da16-c55524160f4f"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(73517, 5)\n",
            "(5,)\n",
            "(34476, 5)\n"
          ]
        }
      ],
      "source": [
        "from sklearn.utils.extmath import randomized_svd\n",
        "import numpy as np \n",
        "# matrix = adjacency_matrix.toarray() # converting to dense matrix\n",
        "U, Sigma, VT = randomized_svd(adjacency_matrix, n_components = 5, n_iter = 5, random_state = None)\n",
        "print(U.shape)\n",
        "print(Sigma.shape)\n",
        "V = VT.T\n",
        "print(V.shape)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Collaborative Filtering"
      ],
      "metadata": {
        "id": "jsipj7Q6t8jT"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "83Vh4NoO_JyU"
      },
      "source": [
        "#### Compute mean of ratings"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "collapsed": true,
        "id": "cBHuCn2QSEnl"
      },
      "outputs": [],
      "source": [
        "def m_u(ratings):\n",
        "    '''In this function, we will compute mean for all the ratings'''\n",
        "    # you can use mean() function to do this\n",
        "    # check this (https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mean.html) link for more details.\n",
        "\n",
        "    return ratings.mean()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 14,
      "metadata": {
        "id": "iu1nn-1x3ebp",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "49b4732a-8e46-4579-c0f8-54e828c3bd43"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "7.808496946857473\n"
          ]
        }
      ],
      "source": [
        "mu = m_u(rating_data['rating'])\n",
        "print(mu)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "qSvAW1X94g3G"
      },
      "source": [
        "#### Computing Biases"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 25,
      "metadata": {
        "collapsed": true,
        "id": "AyEJqPka4lBW"
      },
      "outputs": [],
      "source": [
        "def initialize(dim):\n",
        "    '''In this function, we will initialize bias value 'B' and 'C'.'''\n",
        "    # initalize the value to zeros \n",
        "    # return output as a list of zeros\n",
        "    arr = []\n",
        "    for i in range(0, dim):\n",
        "        arr.append(0)\n",
        "\n",
        "    return arr"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 34,
      "metadata": {
        "collapsed": true,
        "id": "Nlae9QAQ43Xz"
      },
      "outputs": [],
      "source": [
        "dim = np.amax(rows) + 1# give the number of dimensions for b_i (Here b_i corresponds to users)\n",
        "b_i=initialize(dim)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 35,
      "metadata": {
        "collapsed": true,
        "id": "rwuopn4HoEbP"
      },
      "outputs": [],
      "source": [
        "dim = np.amax(columns) + 1 # give the number of dimensions for c_j (Here c_j corresponds to movies)\n",
        "c_j=initialize(dim)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "DTDK4ZR18MrZ"
      },
      "source": [
        "##### Compute dL/db_i"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 28,
      "metadata": {
        "collapsed": true,
        "id": "3NFzVC1N8S4L"
      },
      "outputs": [],
      "source": [
        "def derivative_db(user_id,item_id,rating,U,V,mu,alpha):\n",
        "    '''In this function, we will compute dL/db_i'''\n",
        "    return 2*(mu + 2*b_i[user_id] + c_j[item_id] + U[user_id].dot(V.T[item_id].T) - rating)\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1Kp0hC_b9v60"
      },
      "source": [
        "##### Compute dL/dc_j"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 29,
      "metadata": {
        "collapsed": true,
        "id": "FAtSYMrc9UqJ"
      },
      "outputs": [],
      "source": [
        "def derivative_dc(user_id,item_id,rating,U,V,mu, alpha):\n",
        "    '''In this function, we will compute dL/dc_j'''\n",
        "    return 2*(mu + b_i[user_id] + 2*c_j[item_id] + U[user_id].dot(V.T[item_id].T) - rating)\n"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### SGD + Computing MSE"
      ],
      "metadata": {
        "id": "PBoF-TG3t2vD"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 43,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "WevBRn7Ead8T",
        "outputId": "45a3f2e4-b808-4dc3-c1eb-b5b4d1b8e73e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 104730.98it/s]\n",
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106288.02it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106506.09it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 105981.86it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106244.75it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 105676.27it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 105465.94it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106090.66it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 105076.69it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 105280.98it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 105660.46it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 105156.97it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106633.46it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106337.63it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106629.23it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106399.57it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106374.09it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434, 1.6722644058663234]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106796.41it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434, 1.6722644058663234, 1.6722129421867853]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [01:00<00:00, 105276.16it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434, 1.6722644058663234, 1.6722129421867853, 1.672162821886624]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 6337241/6337241 [00:59<00:00, 106020.95it/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434, 1.6722644058663234, 1.6722129421867853, 1.672162821886624, 1.6721139922463466]\n"
          ]
        }
      ],
      "source": [
        "from tqdm import tqdm\n",
        "from sklearn.metrics import mean_squared_error\n",
        "\n",
        "np_data = rating_data.to_numpy()\n",
        "epochs = 20\n",
        "learning_rate = 0.001\n",
        "mses_1 = []\n",
        "for epoch in range(0, epochs):\n",
        "    y_pred = []\n",
        "    for row in tqdm(np_data):\n",
        "        user = row[0]\n",
        "        movie = row[1]\n",
        "        rating = row[2]\n",
        "        b_i[user] = b_i[user] - learning_rate * derivative_db(user, movie, rating, U, VT, mu, learning_rate)  \n",
        "        c_j[movie] = c_j[movie] - learning_rate * derivative_dc(user, movie, rating, U, VT, mu,learning_rate)\n",
        "            \n",
        "        y_pred.append(mu + b_i[user] + c_j[movie] + U[user].dot(V[movie].T))\n",
        "                \n",
        "    mse = mean_squared_error(rating_data['rating'].values, y_pred)\n",
        "    if(epoch == 0):\n",
        "      mses_1.append(mse)\n",
        "      continue\n",
        "    last_mse = mses_1[-1]\n",
        "    if(mse >= last_mse):\n",
        "      print(\"Error increased..\")\n",
        "      print(mse, last_mse)\n",
        "      break\n",
        "    elif((last_mse - mse) < 0.000001):\n",
        "      print(\"Error did not decrease by much..: \", (mse - last_mse))\n",
        "      print(mse, last_mse)\n",
        "      break \n",
        "    print(mses_1)\n",
        "    mses_1.append(mse)\n",
        "            \n",
        "\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 44,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 332
        },
        "id": "r9lP646Ead8T",
        "outputId": "1dd7005c-fdf9-4016-c3e4-0e5c2c49ceea"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[1.673245029034275, 1.6731643225000694, 1.673086300780238, 1.6730108228863723, 1.6729377593307166, 1.6728669905518256, 1.6727984056851006, 1.672731901578169, 1.6726673819843878, 1.6726047568891962, 1.672543941937835, 1.6724848579422167, 1.6724274304507847, 1.6723715893696318, 1.6723172686258434, 1.6722644058663234, 1.6722129421867853, 1.672162821886624, 1.6721139922463466, 1.6720664033246906]\n"
          ]
        }
      ],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "plt.plot(range(1, len(mses_1) + 1), mses_1, label='MSEs')\n",
        "\n",
        "plt.legend()\n",
        "plt.xlabel(\"epochs\")\n",
        "plt.ylabel(\"MSEs\")\n",
        "plt.title(\"epoch Vs MSE\")\n",
        "plt.grid()\n",
        "plt.show()\n",
        "print(mses_1)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "NeWAGkT6C9kq"
      },
      "source": [
        "### Recommendation for Users"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 52,
      "metadata": {
        "collapsed": true,
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "69Y6adUTad8V",
        "outputId": "4d193493-c086-4fda-a71a-deae42844ef4"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 12294/12294 [00:00<00:00, 172734.16it/s]\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['Kimi no Na wa.', 'Gintama°', 'Gintama&#039;',\n",
              "       'Ginga Eiyuu Densetsu', 'Gintama&#039;: Enchousen'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 52
        }
      ],
      "source": [
        "from tqdm import tqdm\n",
        "# predicting ratings for all the movies for a user\n",
        "def predict_rating_for_user(user_id):\n",
        "  predicted_ratings_for_user = {}\n",
        "  for movie_id in tqdm(anime_data['anime_id'].values):\n",
        "    if(movie_id >= len(c_j)): # if a movie is not rated by any of the users, we cannot predict rating for that movie. This is called cold start problem.\n",
        "      continue # this if condition ignores such movies since matrix factorization cannot solve that issue.\n",
        "    predicted_rating = mu + b_i[user_id] + c_j[movie_id] + U[user_id].dot(V[movie_id].T)\n",
        "    predicted_ratings_for_user[movie_id] = predicted_rating\n",
        "  return predicted_ratings_for_user\n",
        "                                                                          \n",
        "\n",
        "# getting top 5 animes names based on the predicted ratings and recommending it to a user\n",
        "def get_top_5_animes(user_id):\n",
        "  predicted_ratings_for_user = predict_rating_for_user(user_id)\n",
        "  top_5_anime_ids = sorted(predicted_ratings_for_user, key = predicted_ratings_for_user.get, reverse = True)[:5]\n",
        "  # print(top_5_anime_ids)\n",
        "  recommended_movie_data = anime_data[anime_data['anime_id'].isin(top_5_anime_ids)]\n",
        "  # print(recommended_movie_data['name'].values)\n",
        "  return recommended_movie_data['name'].values\n",
        "\n",
        "\n",
        "get_top_5_animes(1)\n",
        "\n",
        "\n"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "collapsed_sections": [
        "7v-3nsDxdLa6",
        "sxsEQeBEfegJ",
        "hhhvUjaz5IQQ",
        "OJPWI9VwD_ih",
        "83Vh4NoO_JyU"
      ],
      "name": "Movie Recommendation system own case study.ipynb",
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.6.2"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}